<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>BEAMINDIA - MY ROBOTS - FIRE - MICROCONTROLLER</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="icon" type="image/x-icon" href="assets/favicon.ico">
<style>
        :root { --accent: #20c997; }
        a { color: var(--accent); }
        .text-accent { color: var(--accent)!important; }

        /* Standard teal headings used across site */
        .section-heading {
            font-weight: 350 !important;
            font-size: 1.2rem !important;
            color: var(--accent) !important;
            margin-top: 2rem;
            margin-bottom: .5rem;
        }

        /* Scrollable, monospaced code block */
        .code-box {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 1rem;
            background: #fafafa;
            font-family: Consolas, "Courier New", monospace;
            font-size: 0.9rem;
            white-space: pre;
        }
    </style>
<link href="assets/style.css" rel="stylesheet">
<link href="assets/navbar.css" rel="stylesheet">
<link href="assets/robot-nav.css" rel="stylesheet">
<link href="assets/fire-subnav.css" rel="stylesheet">
</head>
<body class="bg-white text-dark">

    <!-- NAV -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm"><div class="container">
            <a class="navbar-brand site-brand" href="index.html">BEAMINDIA</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
<li class="nav-item"><a class="nav-link active" href="index.html">Robots</a></li>
                <li class="nav-item"><a class="nav-link" href="basicbeam.html">BEAM</a></li>
                <li class="nav-item"><a class="nav-link" href="se.html">Solar Engine</a></li>
                <li class="nav-item"><a class="nav-link" href="tutorials.html">Tutorials</a></li>
                <li class="nav-item"><a class="nav-link" href="links.html">Links</a></li>
                <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
                </ul>
</div>
        </div>
    </nav><main class="container my-5"><!-- ROBOT SUBNAV --><div class="nav-wrapper overflow-auto">
            <ul class="nav nav-tabs flex-nowrap justify-content-start justify-content-lg-center gap-2 my-3 robot-nav" id="robot-subnav" style="min-width: 480px;">
<li class="nav-item flex-shrink-0"><a class="nav-link active" href="fire.html">Fire</a></li>
                <li class="nav-item flex-shrink-0"><a class="nav-link" href="moby.html">Moby</a></li>
                <li class="nav-item flex-shrink-0"><a class="nav-link" href="twalky.html">Twalky</a></li>
                <li class="nav-item flex-shrink-0"><a class="nav-link" href="scamvee.html">Scamvee</a></li>
            </ul>
</div>

        <!-- SECTION MENU -->
        <div class="fire-subnav">
    <a href="fire.html">Introduction</a> | <a href="firemechanics.html">Mechanics</a> | <a href="firemicrocontroller.html" class="active">Microcontroller</a> | <a href="firemotordriver.html">Motordriver</a> | <a href="firesensors.html">Sensors</a> | <a href="firepowersupply.html">Powersupply</a> | <a href="fireckt.html">Schematic</a> | <a href="firemiscellaneous.html">Miscellaneous</a>
</div>

        <p>
            A microcontroller is similar to a processor in a computer. The primary difference is that the
            microcontroller has the CPU, the flash memory, the RAM and external ports all built into a single chip.
            All this makes the microcontroller very cheap and is true value for money. But where it takes a beating
            is the speed. Microcontrollers are low speed devices when compared to their equivalent microprocessors.
            Faster microcontrollers are available. Since I didn't need complex processing for the robot I settled
            for the microcontroller.
        </p>

        <p>
            FIRE uses an 8051 microcontroller as its CPU. The 8051 has many breeds and I use the one made by ATMEL
            called AT89S8252.
        </p>

        <!-- 8051 FAMILY -->
        <h3 class="section-heading">8051 family</h3>
        <p>
            Intel Corporation first designed 8051 Micro-controller and after several years Intel Corporation gave
            license to other companies like Siemens, Atmel, Dallas Semiconductor, Phillips. The micro-controllers
            designed by other companies are a part of 8051 family and also have the instruction set and same
            architecture. The main difference between the different manufactures is the on-chip memory and type of
            ROM used. The different types of ROM used are Flash, UV RAM, NV RAM and OTP. The commercial product
            from Intel is called 8751 and that Micro-controller used UV ROM. The main disadvantage of using this
            type of ROM was it takes time to erase the chip and program the chip. Atmel introduced micro-controllers
            with Flash ROM. The main advantage is, very easy to program and no need for external hardware for
            erasing the chip. The programming kit itself, erase and then program. Also the time consumed is very
            less and this improved the developing time. Dallas Semiconductor introduced micro-controllers with NV
            RAM. The advantage of this micro-controller is that it can be programmed even when it is on-line. Also
            bit-by-bit programming can be done. Phillips introduced micro-controllers with OTP (One time Programmable)
            memory. The main drawback is that, once the code has been burned in the chip it is not possible to erase
            the chip.
        </p>

        <!-- AT89S8252 SPECIFICATIONS -->
        <h3 class="section-heading">Atmel AT89S8252 specifications</h3>
        <ul>
<li>Compatible with MCS-51™ products</li>
            <li>8 KB in-system reprogrammable flash memory (SPI interface, 1,000 write/erase endurance)</li>
            <li>2 KB EEPROM (100,000 write/erase endurance)</li>
            <li>Operates from 4.0 V to 6.0 V</li>
            <li>Fully static operation: 0 Hz to 24 MHz</li>
            <li>Three-level program memory lock</li>
            <li>256 × 8-bit internal RAM</li>
            <li>32 programmable I/O lines</li>
            <li>Three 16-bit timers/counters</li>
            <li>Nine interrupt sources</li>
            <li>Programmable UART serial channel</li>
            <li>SPI serial interface</li>
            <li>Low-power idle and power-down modes</li>
            <li>Interrupt recovery from power-down</li>
            <li>Programmable watchdog timer</li>
            <li>Dual data pointer</li>
            <li>Power-off flag</li>
        </ul>
<p>
            Download Data sheet <a href="AT89S8252%20data%20sheet.pdf">here</a>
        </p>

        <!-- PIN CONFIGURATION -->
        <h3 class="section-heading">Pin configuration AT89S8252</h3>

        <p>
            <img src="images/FIRE/Microcontroller/micro.GIF" alt="AT89S8252 pin configuration" width="325" height="402" border="3"></p>

        <!-- PORTS -->
        <h3 class="section-heading">Ports</h3>
        <p>
            Ports are the channels through which a microcontroller communicates with the outside world. Out of the
            4 ports available 2 ports are used in FIRE. Port 2 is used to control the 3 motors and are connected to
            the respective motor driver IC's. Port 3 is used for inputs from the obstacle and IR sensors.
        </p>

        <!-- INTERRUPTS -->
        <h3 class="section-heading">Interrupts</h3>
        <p>
            Interrupts are a very important feature of the microcontroller. These are signals which force the
            microcontroller to perform specific actions. The port 3 has 2 pins INT0 and INT1 for receiving external
            interrupt signals. These are the pins where the signals from the sensors are received.
        </p>

        <!-- PROGRAMMING -->
        <h3 class="section-heading">Programming</h3>
        <p>
            For a microcontroller to perform actions, program code has to be written onto the internal memory of
            the microcontroller. This can be done using hardware units called programmers.
        </p>

        <p>
            Find the programmer used for the AT89S8252 at
            <a href="http://www.aec-electronics.co.nz">http://www.aec-electronics.co.nz</a>
        </p>

        <p>
            Details on how to make your own programmer are given. The software for writing the code is also given.
            To write the code I use this software called UMPS (Universal Microprocessor Program Simulator). Using
            this, the program can be written and tested. It also supports many other microcontrollers.
        </p>

        <p>
            After writing the code (.asm extension), it is assembled using an assembler specific to the
            microcontroller (in this case an 8051 assembler). The output of this assembler is an hex file which can
            be written onto the chip using the In System programmer given in the above .
        </p>

        <!-- ALGORITHM -->
        <h3 class="section-heading">Algorithm</h3>
        <p>
            FIRE follows a simple reactive algorithm:
        </p>

        <ol>
<li>Start.</li>
            <li>Camera faces forward (manual control).</li>
            <li>Move forward — both motors running forward.</li>
            <li>Continuously scan Port 3 for obstacle interrupts.</li>
            <li>If the left IR interrupt (IRTL) is triggered, perform a right-side avoidance sequence:
                <ul>
<li>Stop both motors.</li>
                    <li>Rotate the camera 180° to face backward.</li>
                    <li>Reverse for 3 seconds.</li>
                    <li>Rotate the camera 225° to face northeast.</li>
                    <li>Turn right: right motor stops, left motor runs at high speed for 2 seconds.</li>
                    <li>Rotate camera back to face forward.</li>
                </ul>
</li>
            <li>If the right IR interrupt (IRTR) is triggered, perform a left-side avoidance sequence:
                <ul>
<li>Stop both motors.</li>
                    <li>Rotate the camera 180° to face backward.</li>
                    <li>Reverse for 3 seconds.</li>
                    <li>Rotate the camera 135° to face northwest.</li>
                    <li>Turn left: left motor stops, right motor runs at high speed for 2 seconds.</li>
                    <li>Rotate camera back to face forward.</li>
                </ul>
</li>
            <li>If no interrupt is triggered, continue forward motion.</li>
            <li>End.</li>
        </ol>
<!-- CODE --><h3 class="section-heading">Code</h3>

        <pre class="code-box">
        ORG 0000H
        SJMP MAIN
        ORG 0003H
        LJMP LEFTOB
        ORG 0013H
        LJMP RIGHTOB
        
MAIN    MOV IE,#85H   ;Enable External Interrupts  

        MOV R2,#0EH   ;Load Register r2 with 1F(outer 8 bit repeater loop)
LOOP    ACALL DELAY   ;Call Delay Subroutine  
        ACALL FORWARD ;Call Forward Subroutine

DELAY   MOV TMOD,#01H ;Configure Timer Control for Timer 0 mode 1
        MOV TH0,#00H  ;Load high order 8 bit 
        MOV TL0,#00H  ;Load low order 8 bit 
        SETB TR0      ;Start Timer
AGAIN   JNB TF0,AGAIN ;Check for Timer Flag
        CLR TF0       ;Clear timer flag
        CLR TR0       ;clear timer Register
        DJNZ R2,DELAY ;Decrement register R2 and jump if non-zero
        RET           ;Return to main Program

FORWARD MOV P2,#0B8H  ;Forward Motion
        SJMP FORWARD       
        
LEFTOB  MOV IE,#00H   ;Disable all Interrupts
        MOV P2,#0FCH  ;Forceful Stop
        MOV P2,#02H   ;Rotate Camera

        MOV R2,#014H  ;Delay 
        ACALL DELAY   ;Call Delay Subroutine

        MOV P2,#0D4H  ;Reverse Motors

        MOV R2,#01CH  ;Delay 
        ACALL DELAY   ;Call Delay Subroutine

        MOV P2,#0FCH  ;Forceful Stop
        MOV P2,#02H   ;Rotate Camera

        MOV R2,#15H   ;Delay
        ACALL DELAY   ;Call Delay Subroutine

        MOV P2,#0BCH  ;Rotate Left Motor 

        MOV R2,#01CH  ;Delay
        ACALL DELAY   ;Call Delay Subroutine

        MOV P2,#0FCH  ;Forceful Stop
        MOV P2,#02H   ;Rotate Camera

        MOV R2,#01FH  ;Delay
        ACALL DELAY   ;Call Delay Subroutine    
         
        MOV P2,#00H   ;Clear Outputs

        MOV R2,#04H   ;Delay
        ACALL DELAY   ;Call Delay Subroutine 
         
        MOV IE,#85H   ;Enable All Interrupts
        RETI

RIGHTOB MOV IE,00H    ;Disable All Interrupts
        MOV P2,#0FCH  ;Forceful Stop
        MOV P2,#02H   ;Rotate Camera

        MOV R2,#12H   ;Delay
        ACALL DELAY   ;Call Delay Subroutine

        MOV P2,#0D4H  ;Reverse Motors

        MOV R2,#01CH  ;Delay
        ACALL DELAY   ;Call Delay Subroutine 

        MOV P2,#0FCH  ;Forceful Stop
        MOV P2,#02H   ;Rotate Camera

        MOV R2,#0EH   ;Delay
        ACALL DELAY   ;Call Delay Subroutine 
         
        MOV P2,#0F8H  ;Rotate Right Motor

        MOV R2,#1CH   ;Delay
        ACALL DELAY   ;Call Delay Subroutine 

        MOV P2,#0FCH  ;Forceful Stop
        MOV P2,#02H   ;Rotate Camera

        MOV R2,#07H   ;Delay
        ACALL DELAY   ;Call Delay Subroutine 

        MOV P2,#00H   ;Clear Outputs

        MOV R2,#0EH   ;Delay 
        ACALL DELAY   ;Call Delay Subroutine

        MOV IE,#85H   ;Enable All Interrupts
        RETI</pre>

        <!-- CIRCUIT -->
        <h3 class="section-heading">Circuit</h3>
        <p>
            <img src="images/FIRE/Microcontroller/mckt.GIF" alt="Microcontroller circuit" width="444" height="384" border="3"></p>

        <!-- IMAGES -->
        <h3 class="section-heading">Images</h3>
        <p>
            <img src="images/FIRE/Microcontroller/FIRE05.JPG" alt="Programmer and Microcontroller board" width="500" height="465" border="3"></p>
        <p>(Top: Programmer, Bottom: Microcontroller board)</p>

    </main><footer class="bg-white text-center py-4 mt-5 small text-muted border-top"><p>© Viswas Nair TK</p>
    </footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script><script>
    function copyCode(id) {
        const el = document.getElementById(id);
        navigator.clipboard.writeText(el.innerText).then(() => {
            alert("Code copied to clipboard!");
        });
    }
    </script>
</body>
</html>
